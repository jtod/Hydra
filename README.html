<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-07-26 Tue 23:32 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="./docs/doc.css" />
<link rel="stylesheet" type="text/css" href="./docs/doc.css" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1>Hydra README</h1>

<div id="outline-container-org177c561" class="outline-2">
<h2 id="org177c561">About Hydra</h2>
<div class="outline-text-2" id="text-org177c561">
Version 3.4.16
Copyright (c) 2022 John T. O'Donnell

<p>
Hydra is a functional computer hardware description language for
specifying the structure and behavior of digital circuits. It supports
several levels of abstraction, including logic gates, register
transfer level, datapath and control, and processors. There are tools
for simulating circuits, generating netlists, and emulating
instruction set architectures. It is an embedded domain specific
language implemented using Haskell.
</p>

<ul class="org-ul">
<li>The <i>User Guide</i> explains how to use the language; it is available
in <a href="./docs/UserGuide/HydraUserGuide.html">./docs/UserGuide/HydraUserGuide.html</a></li>
<li>The <i>API reference</i> gives types of the exported definitions.  If you
build using cabal, it will be in the the <code>dist-newstyle</code> directory.
The path depends on software versions, but may be something like
this:
<a href="./dist-newstyle/build/x86_64-windows/ghc-9.2.3/hydra-3.4.16/doc/html/hydra/index.html">./dist-newstyle/build/x86_64-windows/ghc-9.2.3/hydra-3.4.16/doc/html/hydra/index.html</a>.
If you install using cabal, it should also be placed in the standard
location for Haskell API references.</li>
</ul>

<p>
This is free and open source software released under the GPL-3
license.
</p>

<ul class="org-ul">
<li>Author: John T. O'Donnell, School of Computing Science, University
of Glasgow</li>
<li>Copyright (c) 2022 John T. O'Donnell</li>
<li>Author's home page: <a href="https://jtod.github.io/index.html">https://jtod.github.io/index.html</a></li>
<li>License: This software is free and open source, released under the
GPL-3 license.  See LICENSE.txt.</li>
<li>Source code repository: <a href="https://github.com/jtod/Hydra">https://github.com/jtod/Hydra</a></li>
<li>Version: see Hydra.cabal</li>
</ul>
</div>
</div>

<div id="outline-container-org82819ef" class="outline-2">
<h2 id="org82819ef">Installation</h2>
<div class="outline-text-2" id="text-org82819ef">
</div>
<div id="outline-container-org354a51f" class="outline-3">
<h3 id="org354a51f">Haskell</h3>
<div class="outline-text-3" id="text-org354a51f">
<p>
Hydra requires the ghc toolset for Haskell, including ghc and cabal.
Haskell installers for Macintosh, Windows, and Linux are available at
<a href="https://www.haskell.org/ghcup/">https://www.haskell.org/ghcup/</a>.
</p>

<p>
For Windows, an alternative approach is to use chocolatey; see
<a href="https://hub.zhox.com/posts/introducing-haskell-dev/">https://hub.zhox.com/posts/introducing-haskell-dev/</a>.  If you have
chocolatey installed, you can use it to install Haskell easily.  Run
these commands in Windows PowerShell with administrator privileges:
</p>

<pre class="example" id="orgdd64a77">
choco install ghc --force -y
choco install cabal --force -y
</pre>

<ul class="org-ul">
<li><code>-y</code> tells choco to answer with y automatically when it needs
permission to do something.  Without the -y, it doesn't actually ask
permission and the whole installation fails.</li>
<li><code>--force</code> shouldn't be necessary but seems to be needed if
installing after a failed installation attempt.</li>
</ul>

<p>
<i>Verify that Haskell is working</i>
</p>

<pre class="example" id="org73d9153">
$ ghc --version
The Glorious Glasgow Haskell Compilation System, version 9.2.3
$ cabal --version
cabal-install version 3.6.2.0
compiled using version 3.6.2.0 of the Cabal library
</pre>

<p>
<i>In case of difficulty</i>
</p>

<p>
If you have a previous installation of ghc, and a new installation
fails, the following might work:
</p>

<pre class="example" id="org0a70143">
choco upgrade ghc cabal -y
</pre>
</div>
</div>

<div id="outline-container-org6e9f3dc" class="outline-3">
<h3 id="org6e9f3dc">Hydra</h3>
<div class="outline-text-3" id="text-org6e9f3dc">
<p>
The Hydra source code is available at <a href="https://github.com/jtod/Hydra">https://github.com/jtod/Hydra</a>.
See the Releases section on the right side of the page and click on
the latest release.  Download the source code file (in the Assets
section), which is available in both <code>zip</code> and <code>.tar.gz</code> format.  Put
the file somewhere in your user workspace and unpack it, using the
correct version number for your download:
</p>

<ul class="org-ul">
<li>On Linux: tar -xzf Hydra-3.5.1.tar.gz</li>
<li>On Windows use zip, 7zip or tar</li>
</ul>

<p>
This will create a directory that contains documentation (<code>docs</code>
directory and <code>examples</code> directory), the source code (<code>src</code>
directory), and build tools.  Install using these commands (using the
right version number for Hydra):
</p>

<pre class="example" id="org8b51f2a">
cd Hydra-3.5.1
cabal install --lib
cabal haddock
</pre>

<p>
<i>Verify that Hydra is working</i>
</p>

<p>
The following commands should simulate a 4-bit word adder for several
clock cycles, with different inputs during each cycle.
</p>

<pre class="example" id="org3ee2117">
$ cd examples/adder
$ ghc -e main Add4Run
</pre>

<p>
<i>In case of difficulty</i>
</p>

<p>
See the user guides for ghc and cabal for more information.  The
<code>ghc-pkg list</code> command shows the installed packages.
</p>

<p>
Sometimes an installation may fail if there was a previous
installation.  If this happens, find the ghc environment default file,
which is located at a path similar to the following (with your
username and the right version numbers):
</p>

<p>
Linux:
</p>
<pre class="example" id="orge9cad83">
~/.ghc/x86_64-linux-8.8.3/environments/default 
</pre>

<p>
Windows:
</p>
<pre class="example" id="org056b817">
C:/Users/username/AppData/Roaming/ghc/x86_64-mingw32-9.2.3/environments/default
</pre>

<p>
Open this file in a text editor and find the line containing an entry
for hydra, which should look something like this:
</p>

<pre class="example" id="org2c7c794">
package-id hydra-3.4.5-VeryLongHashKey
</pre>

<p>
Delete the lines for hydra, save the <code>default</code> file, and try the
<code>cabal install --lib</code> command again.
</p>

<p>
<i>Alternative: using ghci</i>
</p>

<p>
Instead of using the batch command <code>ghc -e main Add4Run</code> (where
Add4Run is the name of a simulation driver), an alternative is to use
the interactive Haskell interpreter:
</p>

<pre class="example" id="org3a7754c">
$ ghci
ghci&gt; :load Add4Run
ghci&gt; :main
ghci&gt; :quit
</pre>

<p>
The ghci interpreter offers a number of debugging and tracing tools.
See the GHC User Guide for details.
</p>

<p>
If you get a message saying that there are "hidden packages", copy the
following into a file named <code>.ghci</code>
</p>
<pre class="example" id="org39e9438">
:set -package mtl
:set -package parsec
:set -package ansi-terminal
</pre>

<p>
<i>Alternative: using cabal</i>
</p>

<p>
You can turn a directory with a circuit and simulation driver into a
cabal package by defining some metadata files.  Once this is done, you
can then execute the driver using the command <code>cabal run driver</code>,
where <code>driver</code> is replaced by the actual name of the simulation
driver.  One advantage of this method is that you can put command line
arguments on the <code>cabal run</code> command, which you cannot do with the
<code>ghc -e main</code>.  See the M1 processor circuit directory for an example.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2022-07-26 Tue 23:32</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
